---
title: "05-quantile-errors"
output: html_document
---

## Data Science 5620 --- Deliverable 05
### Quantile Error
### Rastko Stojsin


```{r}
library(ggplot2)
library(tidyverse)
```

LOOK HERE

```{r}
calc_summary <- function(p) {
  rand_sample_grid <- matrix(NA, ncol=length(p), nrow=5000)
  
  for(i in 1:5000){
    resamp.data <- rnorm(200)
    rand_sample_grid[i,] <- quantile(resamp.data,p)
  }
  
  return(rand_sample_grid)
}

rand_sample_grid <- calc_summary(p=seq(0.05,0.95,by=0.05))
```

```{r}

mid.length <- apply(rand_sample_grid, 2, function(x) quantile(x,0.975)-quantile(x, 0.025))

plot(seq(0.05,0.95,by=0.05), mid.length)

plot(dnorm(qnorm(seq(0.05,0.95,by=0.05))), mid.length)
```



```{r}
calc_summary <- function(p) {
  rand_sample_grid <- matrix(NA, ncol=length(p), nrow=5000)
  
  for(i in 1:5000){
    resamp.data <- rexp(200)
    rand_sample_grid[i,] <- quantile(resamp.data,p)
  }
  
  return(rand_sample_grid)
}

rand_sample_grid <- calc_summary(p=seq(0.05,0.95,by=0.05))
```

```{r}

mid.length <- apply(rand_sample_grid, 2, function(x) quantile(x,0.975)-quantile(x, 0.025))

plot(seq(0.05,0.95,by=0.05), mid.length)

plot(dexp(qexp(seq(0.05,0.95,by=0.05))), mid.length)
```
highest density smallest middle length - persice

```{r}
rf3 <- function(N){
  G <- sample(0:2, N, replace = TRUE, prob = c(5,3,2))
  (G==0)*rnorm(N) + (G==1)*rnorm(N,4) + (G==2)*rnorm(N,-4,2)
}

pf3 <- function(x){
  .5*pnorm(x) + .3*pnorm(x,4) + .2*pnorm(x,-4,2)
}

df3 <- function(x){
  .5*dnorm(x) + .3*dnorm(x,4) + .2*dnorm(x,-4,2)
}

rf4 <- function(N){
  G <- sample(0:1, N, replace = TRUE)
  (G==0)*rbeta(N,5,1) + (G==1)*rbeta(N,1,5)
}
```




